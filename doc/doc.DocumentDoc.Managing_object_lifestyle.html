<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<title>Sinobu API</title>
		<base href="../"/>
		<script async="true" src="highlight.js" type="module"></script>
		<script src="mimic.js" type="module"></script>
		<link href="main.css" rel="stylesheet"/>
	</head>
	<body class="R">
		<header class="b">
			<h1 class="i" date="2022-02-23" ver="2.15.0"><code>Sinobu</code></h1>
			<nav class="d"><a href="doc/doc.DocumentDoc.Introduction.html"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#text"/>
					</svg>Document</a><a href="api/"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#package"/>
					</svg><code>API</code></a><a href="https://github.com//teletha/sinobu/discussions" target="_blank"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#user"/>
					</svg>Community</a><a href="doc/changelog.html"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#activity"/>
					</svg>Activity</a><a href="https://github.com//teletha/sinobu" target="_blank"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#github"/>
					</svg>Repository</a></nav>
			<div class="H" id="ViewMode"><a id="light" title="Change to a brighter color scheme"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#sun"/>
					</svg>
				</a><a id="dark" title="Change to a darker color scheme"><svg class="A svg" viewBox="0 0 24 24">
						<use href="main.svg#moon"/>
					</svg>
				</a></div>
		</header>
		<main class="k">
			<nav class="l">
				<div></div>
			</nav>
			<article class="K" id="Article">
				<section class="h B" id="doc.DocumentDoc.Managing_object_lifestyle.What_do_you_mean_by_lifestyle_">
					<header class="B c">
						<h2>What do you mean by lifestyle?</h2>
						<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#copy"/>
								</svg>
							</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#twitter"/>
								</svg>
							</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L103-L107"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#edit"/>
								</svg>
							</a></div>
					</header><span class="B"><p>
 In Sinobu, lifestyle refers to the way an object is created and managed, corresponding to
 the scope in terms of DI containers such as SpringFramework and Guice, but without the
 process of registering with the container or destroying the object.
 </p>
					</span>
					<section class="B Q" id="doc.DocumentDoc.Managing_object_lifestyle.What_do_you_mean_by_lifestyle_.Creating_an_object">
						<header class="B c">
							<h3>Creating an object</h3>
							<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#copy"/>
									</svg>
								</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#twitter"/>
									</svg>
								</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L112-L133"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#edit"/>
									</svg>
								</a></div>
						</header><span class="B"><p>
 In Java, it is common to use the new operator on the constructor to create a new
 object. In many cases, this is sufficient, but in the following situations, it is a
 bit insufficient.
 </p>
 <ul>
 
								<li>To manage the number of objects to be created.</li>
 
								<li>To create objects associated with a specific context.</li>
 
								<li>To generate objects with complex dependencies.</li>
 
								<li>The type of the object to be generated is not statically determined.</li>
 </ul>
 <p>
 While DI containers such as SpringFramework or Guice are commonly used to deal with
 such problems, Sinobu comes with its own very simple DI container. The following code
 shows the creation of an object using DI container.
 </p>
 <pre class="lang-java"><code>void createObject() {
    Person someone = I.make(Person.class);
    assert someone != null;
}</code></pre>
 <p>
 As you can see from the above code, there is no actual container object; Sinobu has
 only one global container in the JVM, and that object cannot be accessed directly. In
 order to create an object from a container, we need to call <code><a href="api/kiss.I.html#make(java.lang.Class)">I#make(Class)</a></code>.
 </p>
						</span></section>
				</section>
				<section class="h B" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle">
					<header class="B c">
						<h2>Defining lifestyle</h2>
						<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#copy"/>
								</svg>
							</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#twitter"/>
								</svg>
							</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L145-L168"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#edit"/>
								</svg>
							</a></div>
					</header><span class="B"><p>
 In order to define a lifestyle, we need to write a <code><a href="api/kiss.Lifestyle.html">Lifestyle</a></code> interface. This
 interface is essentially equivalent to <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/Callable.html">Callable</a></code>, but it is called when a specific
 Type (class or interface) is requested for a container, and it makes the following 3
 decisions:
 </p>
 <ol>
 
							<li>Which class to instantiate actually.</li>
 
							<li>How to instantiate it.</li>
 
							<li>How to manage the instances.</li>
 </ol>
 <p>
 As the simplest example, let&#39;s consider a prototype pattern that creates a new instance
 using the new operator each time it is requested. The following implementation is called
 every time an instance of Person is requested for the container, and creates and returns
 a new instance.
 </p>
 <pre class="lang-java"><code>class Prototype implements Lifestyle&#60;Person&#62; {

    public Person call() throws Exception {
        return new Person();
    }
}</code></pre>
 <p>
 This kind of prototype pattern is set as the default lifestyle in Sinobu because it is
 expected to be used most often. Also, you can use <code><a href="api/kiss.I.html#prototype(java.lang.Class)">I#prototype(Class)</a></code> to generate
 prototypical lifestyles for any type, so there is no need to actually write such an
 implementation.
 </p>
					</span>
					<section class="B Q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Pre_defined_lifestyle">
						<header class="B c">
							<h3>Pre defined lifestyle</h3>
							<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#copy"/>
									</svg>
								</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#twitter"/>
									</svg>
								</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L181-L192"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#edit"/>
									</svg>
								</a></div>
						</header><span class="B"><p>
 Sinobu comes with two pre-defined lifestyles. One is the prototype lifestyle
 described earlier, which generates a new instant every time it is requested. This is
 the default lifestyle in Sinobu, so you do not need to make any special settings to
 use it.
 </p>
 <pre class="lang-java"><code>public void prototype() {
    class Person {
    }

    Person someone = I.make(Person.class);
    Person anyone = I.make(Person.class);
    assert someone != anyone; // two different instances
}</code></pre>
 <p>
 The other is the singleton lifestyle, which keeps a single instance in the JVM and
 always returns it.
 </p>
 <pre class="lang-java"><code>public void singleton() {
    @Managed(Singleton.class)
    class Earth {
    }

    Earth one = I.make(Earth.class);
    Earth other = I.make(Earth.class);
    assert one == other; // same instance
}</code></pre>
						</span></section>
					<section class="B Q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Custom_lifestyle">
						<header class="B c">
							<h3>Custom lifestyle</h3>
							<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#copy"/>
									</svg>
								</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#twitter"/>
									</svg>
								</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L198-L202"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#edit"/>
									</svg>
								</a></div>
						</header><span class="B"><p>
 You can also define new lifestyles based on arbitrary contexts by implementing the
 <code><a href="api/kiss.Lifestyle.html">Lifestyle</a></code> interface and defining a constructor to receive the requested type.
 </p>
 <pre class="lang-java"><code>class PerThread&#60;T&#62; implements Lifestyle&#60;T&#62; {
    private final ThreadLocal&#60;T&#62; local;

    PerThread(Class&#60;T&#62; requestedType) {
        local = ThreadLocal.withInitial(() -&#62; {
            try {
                return requestedType.getDeclaredConstructor().newInstance();
            } catch (Exception e) {
                throw new Error(e);
            }
        });
    }

    public T call() throws Exception {
        return local.get();
    }
}</code></pre>
						</span></section>
					<section class="B Q" id="doc.DocumentDoc.Managing_object_lifestyle.Defining_lifestyle.Builtin_types">
						<header class="B c">
							<h3>Builtin types</h3>
							<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#copy"/>
									</svg>
								</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#twitter"/>
									</svg>
								</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L227-L239"><svg class="A svg" viewBox="0 0 24 24">
										<use href="main.svg#edit"/>
									</svg>
								</a></div>
						</header><span class="B"><p>
 Sinobu comes with built-in lifestles for the following types.
 </p>
 <dl>
 
								<dt><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html">List</a></code>
 
									<dd>Generate a new <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/ArrayList.html">ArrayList</a></code> each time.</dd>
 
									<dt><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html">Set</a></code>
 
										<dd>Generate a new <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/HashSet.html">HashSet</a></code> each time.</dd>
 
										<dt><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html">Map</a></code>
 
											<dd>Generate a new <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/HashMap.html">HashMap</a></code> each time.</dd>
 
											<dt><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Locale.html">Locale</a></code>
 
												<dd>Always returns the instance retrieved from <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Locale.html#getDefault()">Locale#getDefault()</a></code>.</dd>
 </dt>
										</dt>
									</dt>
								</dt>
							</dl>
						</span></section>
				</section>
				<section class="h B" id="doc.DocumentDoc.Managing_object_lifestyle.Registering_lifestyle">
					<header class="B c">
						<h2>Registering lifestyle</h2>
						<div class="j"><a class="perp X"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#copy"/>
								</svg>
							</a><a class="tweet X"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#twitter"/>
								</svg>
							</a><a class="edit X" href="https://github.com//teletha/sinobu/edit/master/src/test/java/doc/DocumentDoc.java#L246-L263"><svg class="A svg" viewBox="0 0 24 24">
									<use href="main.svg#edit"/>
								</svg>
							</a></div>
					</header><span class="B"><p>
 To use a lifestyle other than the prototype lifestyle, you need to individually configure
 the lifestyle to be used in the class. There are two ways to do this, one is to use
 <code><a href="api/kiss.Managed.html">Managed</a></code> annotation. This way is useful if you want to specify a lifestyle for a
 class that is under your control. The following is an example of using the
 <code><a href="api/kiss.Singleton.html">Singleton</a></code> lifestyle.
 </p>
 <pre class="lang-java"><code>@Managed(Singleton.class)
class Earth {
}</code></pre>
 <p>
 <code><a href="api/kiss.Managed.html">Managed</a></code> annotation specifies the implementation of <code><a href="api/kiss.Lifestyle.html">Lifestyle</a></code> you want to
 use, but if none is specified, it is treated as if a prototype lifestyle is specified.
 </p>
 <p>
 The other is defining custom <code><a href="api/kiss.Lifestyle.html">Lifestyle</a></code>. Sinobu recognizes it automatically if
 your custom lifestyle class is loaded or unloaded by <code><a href="api/kiss.I.html#load(java.lang.Class)">I#load(Class)</a></code> and
 <code><a href="api/kiss.Disposable.html#dispose()">Disposable#dispose()</a></code>methods. The following is example.
 </p>
 <pre class="lang-java"><code>class SingletonLocale implements Lifestyle&#60;Locale&#62; {

    private static final Locale singleton = Locale.forLanguageTag(&#34;language-tag&#34;);

    public Locale call() throws Exception {
        return singleton;
    }
}</code></pre>
					</span></section>
			</article>
			<aside class="N" id="SubNavi">
				<div class="V"></div>
			</aside>
		</main>
		<script src="root.js"></script>
		<script src="main.js" type="module"></script>
	</body>
</html>